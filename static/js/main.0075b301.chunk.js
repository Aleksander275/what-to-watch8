(this.webpackJsonpproject=this.webpackJsonpproject||[]).push([[0],{71:function(e,t,a){"use strict";a.r(t),a.d(t,"store",(function(){return ve}));var c,r,n=a(1),s=a.n(n),i=a(17),l=a.n(i),o=a(5);!function(e){e.Main="/what-to-watch8/",e.Movie="/what-to-watch8/movies/:id",e.MyList="/my-list",e.Player="/player/:id",e.SingIn="/sing-in",e.Review="/movies/:id/new-review",e.Error="/error"}(c||(c={})),function(e){e.Auth="AUTH",e.NoAuth="NO_AUTH",e.Unknown="UNKNOWN"}(r||(r={}));var d,j;!function(e){e.ChangeActiveGenre="films/changeActiveGenre",e.GetFilms="films/getFilms",e.IncreaseCountFilms="filmsList/IncreaseCountFilms",e.ResetCount="filmsList/ResetCount",e.ResetFilm="film/ResetFilm",e.LoadFilms="data/LoadFilms",e.LoadFilmsSimilar="data/LoadFilmsSimilar",e.LoadFilm="data/LoadFilm",e.LoadFilmPromo="film/LoadFilmPromo",e.LoadfilmsFavorite="data/LoadFilmsFavorite",e.LoadReviews="data/LoadReviews",e.LoadUser="data/LoadUser",e.RequireAuthorization="user/RequireAuthorization",e.RequireLogout="user/RequireLogout",e.RedirectToRoute="login/redirectToRoute"}(d||(d={})),function(e){e.Promo="/promo",e.Films="/films",e.Favorite="/favorite",e.Login="/login",e.Logout="/logout",e.Comments="/comments",e.Review="/comments/:film_id"}(j||(j={}));var u=a(2),m=a(6),b=a.n(m),h=a(14),f="what-to-watch",O=function(e){localStorage.setItem(f,e)},v=a(20),x=a.n(v),_=a(36),p=a.n(_),g=function(e){return Object.assign({},e,{posterImage:e.poster_image,previewImage:e.preview_image,backgroundImage:e.background_image,backgroundColor:e.background_color,videoLink:e.video_link,previewVideoLink:e.preview_video_link,scoresCount:e.scores_count,runTime:e.run_time,isFavorite:e.is_favorite})};x.a.extend(p.a);var N=function(e){switch(!0){case 0<=e&&e<3:return"Bad";case 3<=e&&e<5:return"Normal";case 5<=e&&e<8:return"Good";case 8<=e&&e<10:return"Very good";case 10<=e:return"Awesome";default:return""}},w=function(e){return{type:d.LoadUser,payload:{user:e}}},y=a(16),k=function(e){return function(){var t=Object(h.a)(b.a.mark((function t(a,c,r){var n,s,i;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,r.get("".concat(j.Films,"/").concat(e));case 2:n=t.sent,s=n.data,i=g(s),a((c=i,{type:d.LoadFilm,payload:{film:c}}));case 6:case"end":return t.stop()}var c}),t)})));return function(e,a,c){return t.apply(this,arguments)}}()},L=function(){return function(){var e=Object(h.a)(b.a.mark((function e(t,a,c){var r,n,s;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.get(j.Promo);case 2:r=e.sent,n=r.data,s=g(n),t((a=s,{type:d.LoadFilmPromo,payload:{filmPromo:a}}));case 6:case"end":return e.stop()}var a}),e)})));return function(t,a,c){return e.apply(this,arguments)}}()},F=function(){return function(){var e=Object(h.a)(b.a.mark((function e(t,a,c){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,c.get(j.Login).then((function(e){var a,c=(a=e.data,Object.assign({},a,{avatarUrl:a.avatar_url}));t(w(c))}));case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),y.b.info("\u041d\u0435 \u0437\u0430\u0431\u0443\u0434\u044c\u0442\u0435 \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u043e\u0432\u0430\u0442\u044c\u0441\u044f");case 8:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(t,a,c){return e.apply(this,arguments)}}()},S=a(40),R=a(8),C=a(0);var I=function(e){var t=e.films,a=Object(u.c)((function(e){return e.genre})),c=Object(u.b)(),r=Object(n.useState)(a),s=Object(R.a)(r,2),i=s[0],l=s[1],o=["All genres"].concat(Object(S.a)(new Set(t.map((function(e){return e.genre}))))),j=function(e){c(function(e){return{type:d.ChangeActiveGenre,payload:e}}(e))},m=function(){c({type:d.ResetCount})},b=function(e){return i===e?"catalog__genres-item catalog__genres-item--active":"catalog__genres-item"};return Object(C.jsx)("ul",{className:"catalog__genres-list",children:o.map((function(e){return Object(C.jsx)("li",{className:b(e),children:Object(C.jsx)("a",{href:"/",className:"catalog__genres-link",onClick:function(t){t.preventDefault(),j(e),l(e),m()},children:e})},e)}))})};var A=function(){return Object(C.jsx)("p",{children:"Loading ..."})},M=a(7);function T(){return Object(C.jsx)("div",{className:"logo",children:Object(C.jsxs)(M.a,{to:c.Main,className:"logo__link logo__link--light",children:[Object(C.jsx)("span",{className:"logo__letter logo__letter--1",children:"W"}),Object(C.jsx)("span",{className:"logo__letter logo__letter--2",children:"T"}),Object(C.jsx)("span",{className:"logo__letter logo__letter--3",children:"W"})]})})}var P=function(){return Object(C.jsxs)(M.a,{className:"logo__link",to:c.Main,children:[Object(C.jsx)("span",{className:"logo__letter logo__letter--1",children:"W"}),Object(C.jsx)("span",{className:"logo__letter logo__letter--2",children:"T"}),Object(C.jsx)("span",{className:"logo__letter logo__letter--3",children:"W"})]})},U={display:"flex",justifyContent:"center",alignItems:"center"};var W=function(e){var t=e.film,a=Object(n.useState)(!1),c=Object(R.a)(a,2),r=c[0],s=c[1],i=Object(n.useState)(!1),l=Object(R.a)(i,2),o=l[0],d=l[1];Object(n.useEffect)((function(){if(r){var e=setTimeout((function(){d(!0)}),1e3);return function(){return clearTimeout(e)}}}),[r]);var j=r&&o;return Object(C.jsxs)("article",{onMouseEnter:function(){return s(!0)},onMouseLeave:function(){s(!1),d(!1)},className:"small-film-card catalog__films-card",children:[j&&Object(C.jsx)("div",{style:U,children:Object(C.jsx)("video",{src:t.previewVideoLink,autoPlay:!0,muted:!0,poster:t.previewImage,width:"280",height:"175",style:{objectFit:"cover"}})}),!j&&Object(C.jsx)("div",{className:"small-film-card__image",children:Object(C.jsx)("img",{src:t.previewImage,alt:t.name,width:"280",height:"175"})}),Object(C.jsx)("h3",{className:"small-film-card__title",children:Object(C.jsx)(M.a,{className:"small-film-card__link",to:"/what-to-watch8/movies/".concat(t.id),children:t.name})})]})};var z=function(e){var t=e.films;return Object(C.jsx)("div",{className:"catalog__films-list",children:t.map((function(e){return Object(C.jsx)(W,{film:e},e.id)}))})};var D=function(){var e=Object(u.b)();return Object(C.jsx)("div",{className:"catalog__more",children:Object(C.jsx)("button",{onClick:function(){var t;e((t=8,{type:d.IncreaseCountFilms,payload:t}))},className:"catalog__button",type:"button",children:"Show more"})})};var q=function(){var e=Object(u.b)(),t=Object(u.c)((function(e){return e.user}));return Object(u.c)((function(e){return e.authorizationStatus}))!==r.Auth?Object(C.jsx)("div",{className:"user-block",children:Object(C.jsx)(M.a,{to:c.SingIn,className:"user-block__link",children:"Sign in"})}):Object(C.jsxs)("ul",{className:"user-block",children:[Object(C.jsx)("li",{className:"user-block__item",children:Object(C.jsx)("div",{className:"user-block__avatar",children:Object(C.jsx)("img",{src:t.avatarUrl,alt:"User avatar",width:"63",height:"63"})})}),Object(C.jsx)("li",{className:"user-block__item",onClick:function(){e(function(){var e=Object(h.a)(b.a.mark((function e(t,a,c){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:c.delete(j.Logout),localStorage.removeItem(f),t(w({id:0,email:"",name:"",avatarUrl:"",token:""})),t({type:d.RequireLogout});case 4:case"end":return e.stop()}}),e)})));return function(t,a,c){return e.apply(this,arguments)}}())},children:Object(C.jsx)(M.a,{to:c.Main,className:"user-block__link",children:"Sign out"})})]})};var E=function(){var e=Object(u.c)((function(e){return e.films})),t=Object(u.c)((function(e){return e.filmPromo})),a=Object(u.c)((function(e){return e.genre})),n=Object(u.c)((function(e){return e.count})),i=Object(u.c)((function(e){return e.authorizationStatus})),l=Object(o.g)(),d=Object(u.b)(),j=null===t||void 0===t?void 0:t.isFavorite,m=function(e,t){e&&d(function(e,t){return function(){var a=Object(h.a)(b.a.mark((function a(c,r,n){return b.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,n.post("/favorite/".concat(e,"/").concat(t));case 2:c(L());case 3:case"end":return a.stop()}}),a)})));return function(e,t,c){return a.apply(this,arguments)}}()}(e,t))},f=e.filter((function(e){return"All genres"===a?e:e.genre===a})),O=f.slice(0,n),v=e.length>n&&O.length<f.length;return null===t?Object(C.jsx)(A,{}):Object(C.jsxs)(s.a.Fragment,{children:[Object(C.jsxs)("section",{className:"film-card",children:[Object(C.jsx)("div",{className:"film-card__bg",children:Object(C.jsx)("img",{src:t.backgroundImage,alt:t.name})}),Object(C.jsx)("h1",{className:"visually-hidden",children:"WTW"}),Object(C.jsxs)("header",{className:"page-header film-card__head",children:[Object(C.jsx)("div",{className:"logo",children:Object(C.jsx)(P,{})}),Object(C.jsx)(q,{})]}),Object(C.jsx)("div",{className:"film-card__wrap",children:Object(C.jsxs)("div",{className:"film-card__info",children:[Object(C.jsx)("div",{className:"film-card__poster",children:Object(C.jsx)("img",{src:t.posterImage,alt:t.name,width:"218",height:"327"})}),Object(C.jsxs)("div",{className:"film-card__desc",children:[Object(C.jsx)("h2",{className:"film-card__title",children:t.name}),Object(C.jsxs)("p",{className:"film-card__meta",children:[Object(C.jsx)("span",{className:"film-card__genre",children:t.genre}),Object(C.jsx)("span",{className:"film-card__year",children:t.released})]}),Object(C.jsxs)("div",{className:"film-card__buttons",children:[Object(C.jsxs)("button",{className:"btn btn--play film-card__button",type:"button",onClick:function(){return l.push("/player/".concat(t.id))},children:[Object(C.jsx)("svg",{viewBox:"0 0 19 19",width:"19",height:"19",children:Object(C.jsx)("use",{xlinkHref:"#play-s"})}),Object(C.jsx)("span",{children:"Play"})]}),Object(C.jsx)("button",{className:"btn btn--list film-card__button",type:"button",style:{justifyContent:"center"},onClick:function(){return l.push(c.MyList)},children:Object(C.jsx)("span",{children:"My list"})}),i===r.Auth?Object(C.jsxs)("button",{className:"btn btn--list film-card__button",type:"button",onClick:function(){return m(t.id,Number(!j))},children:[j?"":Object(C.jsx)("svg",{viewBox:"0 0 19 20",width:"19",height:"20",children:Object(C.jsx)("use",{xlinkHref:"#add"})}),Object(C.jsx)("span",{children:j?"Remove from my List":"Add to my list"})]}):""]})]})]})})]}),Object(C.jsxs)("div",{className:"page-content",children:[Object(C.jsxs)("section",{className:"catalog",children:[Object(C.jsx)("h2",{className:"catalog__title visually-hidden",children:"Catalog"}),Object(C.jsx)(I,{films:e}),Object(C.jsx)(z,{films:O}),v&&Object(C.jsx)(D,{})]}),Object(C.jsxs)("footer",{className:"page-footer",children:[Object(C.jsx)(T,{}),Object(C.jsx)("div",{className:"copyright",children:Object(C.jsx)("p",{children:"\xa9 2019 What to watch Ltd."})})]})]})]})};var H=function(e){var t=e.film,a=Math.floor(t.runTime/60),c=t.runTime%60;return Object(C.jsxs)("div",{className:"film-card__text film-card__row",children:[Object(C.jsxs)("div",{className:"film-card__text-col",children:[Object(C.jsxs)("p",{className:"film-card__details-item",children:[Object(C.jsx)("strong",{className:"film-card__details-name",children:"Director"}),Object(C.jsx)("span",{className:"film-card__details-value",children:t.director})]}),Object(C.jsxs)("div",{className:"film-card__details-item",children:[Object(C.jsx)("strong",{className:"film-card__details-name",children:"Starring"}),Object(C.jsx)("div",{className:"film-card__details-value",children:t.starring.map((function(e){return Object(C.jsxs)("div",{children:[e,","]},e)}))})]})]}),Object(C.jsxs)("div",{className:"film-card__text-col",children:[Object(C.jsxs)("p",{className:"film-card__details-item",children:[Object(C.jsx)("strong",{className:"film-card__details-name",children:"Run Time"}),Object(C.jsxs)("span",{className:"film-card__details-value",children:[a,"h ",c,"m"]})]}),Object(C.jsxs)("p",{className:"film-card__details-item",children:[Object(C.jsx)("strong",{className:"film-card__details-name",children:"Genre"}),Object(C.jsx)("span",{className:"film-card__details-value",children:t.genre})]}),Object(C.jsxs)("p",{className:"film-card__details-item",children:[Object(C.jsx)("strong",{className:"film-card__details-name",children:"Released"}),Object(C.jsx)("span",{className:"film-card__details-value",children:t.released})]})]})]})};var G=function(e){var t=e.film;return Object(C.jsxs)(C.Fragment,{children:[Object(C.jsxs)("div",{className:"film-rating",children:[Object(C.jsx)("div",{className:"film-rating__score",children:t.rating}),Object(C.jsxs)("p",{className:"film-rating__meta",children:[Object(C.jsx)("span",{className:"film-rating__level",children:N(t.rating)}),Object(C.jsxs)("span",{className:"film-rating__count",children:[t.scoresCount," ratings"]})]})]}),Object(C.jsxs)("div",{className:"film-card__text",children:[Object(C.jsx)("p",{children:t.description}),Object(C.jsx)("p",{className:"film-card__director",children:Object(C.jsxs)("strong",{children:["Director: ",t.director]})}),Object(C.jsx)("p",{className:"film-card__starring",children:Object(C.jsxs)("strong",{children:["Starring: ",t.starring.join(", ")," and other"]})})]})]})};var B=function(e){var t=e.review,a=x()(t.date).format("MMMM DD, YYYY");return Object(C.jsxs)("div",{className:"review",children:[Object(C.jsxs)("blockquote",{className:"review__quote",children:[Object(C.jsx)("p",{className:"review__text",children:t.comment}),Object(C.jsxs)("footer",{className:"review__details",children:[Object(C.jsx)("cite",{className:"review__author",children:t.user.name}),Object(C.jsx)("time",{className:"review__date",dateTime:"2016-12-24",children:a})]})]}),Object(C.jsx)("div",{className:"review__rating",children:t.rating})]})};function V(e){var t=Math.ceil(e.length/2);return e.slice(0,t)}function Y(e){return e.slice(V(e).length)}var J=function(e){var t=e.id,a=Object(u.c)((function(e){return e.reviews}));return Object(n.useEffect)((function(){ve.dispatch(function(e){return function(){var t=Object(h.a)(b.a.mark((function t(a,c,r){var n,s;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,r.get("".concat(j.Comments,"/").concat(e));case 2:n=t.sent,s=n.data,a((c=s,{type:d.LoadReviews,payload:{reviews:c}}));case 5:case"end":return t.stop()}var c}),t)})));return function(e,a,c){return t.apply(this,arguments)}}()}(t.toString()))}),[t]),Object(C.jsxs)("div",{className:"film-card__reviews film-card__row",children:[Object(C.jsx)("div",{className:"film-card__reviews-col",children:V(a).map((function(e,t){return Object(C.jsx)(B,{review:e},t)}))}),Object(C.jsx)("div",{className:"film-card__reviews-col",children:Y(a).map((function(e,t){return Object(C.jsx)(B,{review:e},t)}))})]})};function K(e,t){switch(e){default:return Object(C.jsx)(G,{film:t});case"Details":return Object(C.jsx)(H,{film:t});case"Reviews":return Object(C.jsx)(J,{id:t.id})}}var Q=function(e){var t=e.film,a=Object(n.useState)("Overview"),c=Object(R.a)(a,2),r=c[0],s=c[1],i=Object(n.useState)(0),l=Object(R.a)(i,2),o=l[0],d=l[1];return Object(C.jsxs)(C.Fragment,{children:[Object(C.jsx)("nav",{className:"film-nav film-card__nav",children:Object(C.jsxs)("ul",{className:"film-nav__list",children:[Object(C.jsx)("li",{className:"film-nav__item ".concat(0===o?"film-nav__item--active":""),children:Object(C.jsx)(M.a,{to:"/movies/".concat(t.id),onClick:function(){s("Overview"),d(0)},className:"film-nav__link",children:"Overview"})}),Object(C.jsx)("li",{className:"film-nav__item ".concat(1===o?"film-nav__item--active":""),children:Object(C.jsx)(M.a,{to:"/movies/".concat(t.id),onClick:function(){s("Details"),d(1)},className:"film-nav__link",children:"Details"})}),Object(C.jsx)("li",{className:"film-nav__item ".concat(2===o?"film-nav__item--active":""),children:Object(C.jsx)(M.a,{to:"/movies/".concat(t.id),onClick:function(){s("Reviews"),d(2)},className:"film-nav__link",children:"Reviews"})})]})}),K(r,t)]})};var X=function(){var e=Object(o.h)().id,t=Object(o.g)(),a=Object(u.b)();Object(n.useEffect)((function(){return ve.dispatch(k(e)),ve.dispatch(function(e){return function(){var t=Object(h.a)(b.a.mark((function t(a,c,r){var n,s,i;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,r.get("".concat(j.Films,"/").concat(e,"/similar"));case 2:n=t.sent,s=n.data,i=s.map((function(e){return g(e)})),a((c=i,{type:d.LoadFilmsSimilar,payload:{filmsSimilar:c}}));case 6:case"end":return t.stop()}var c}),t)})));return function(e,a,c){return t.apply(this,arguments)}}()}(e)),function(){a({type:d.ResetFilm})}}),[e,a]);var i=Object(u.c)((function(e){return e.film})),l=Object(u.c)((function(e){return e.isFilmLoaded})),m=Object(u.c)((function(e){return e.filmsSimilar})),f=Object(u.c)((function(e){return e.isFilmsSimilarLoaded})),O=Object(u.c)((function(e){return e.authorizationStatus})),v=null===i||void 0===i?void 0:i.isFavorite,x=function(e,t){e&&a(function(e,t){return function(){var a=Object(h.a)(b.a.mark((function a(c,r,n){return b.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,n.post("/favorite/".concat(e,"/").concat(t));case 2:c(k(e.toString()));case 3:case"end":return a.stop()}}),a)})));return function(e,t,c){return a.apply(this,arguments)}}()}(e,t))};return l||f?Object(C.jsxs)(s.a.Fragment,{children:[Object(C.jsxs)("section",{className:"film-card film-card--full",style:{background:null===i||void 0===i?void 0:i.backgroundColor},children:[Object(C.jsxs)("div",{className:"film-card__hero",children:[Object(C.jsx)("div",{className:"film-card__bg",children:Object(C.jsx)("img",{src:null===i||void 0===i?void 0:i.backgroundImage,alt:null===i||void 0===i?void 0:i.name})}),Object(C.jsx)("h1",{className:"visually-hidden",children:"WTW"}),Object(C.jsxs)("header",{className:"page-header film-card__head",children:[Object(C.jsx)("div",{className:"logo",children:Object(C.jsx)(P,{})}),Object(C.jsx)(q,{})]}),Object(C.jsx)("div",{className:"film-card__wrap",children:Object(C.jsxs)("div",{className:"film-card__desc",children:[Object(C.jsx)("h2",{className:"film-card__title",children:null===i||void 0===i?void 0:i.name}),Object(C.jsxs)("p",{className:"film-card__meta",children:[Object(C.jsx)("span",{className:"film-card__genre",children:null===i||void 0===i?void 0:i.genre}),Object(C.jsx)("span",{className:"film-card__year",children:null===i||void 0===i?void 0:i.released})]}),Object(C.jsxs)("div",{className:"film-card__buttons",children:[Object(C.jsxs)("button",{className:"btn btn--play film-card__button",type:"button",onClick:function(){return t.push("/player/".concat(null===i||void 0===i?void 0:i.id))},children:[Object(C.jsx)("svg",{viewBox:"0 0 19 19",width:"19",height:"19",children:Object(C.jsx)("use",{xlinkHref:"#play-s"})}),Object(C.jsx)("span",{children:"Play"})]}),Object(C.jsx)("button",{className:"btn btn--list film-card__button",type:"button",style:{justifyContent:"center"},onClick:function(){return t.push(c.MyList)},children:Object(C.jsx)("span",{children:"My list"})}),O===r.Auth?Object(C.jsxs)("button",{className:"btn btn--list film-card__button",type:"button",onClick:function(){return x(i.id,Number(!v))},children:[v?"":Object(C.jsx)("svg",{viewBox:"0 0 19 20",width:"19",height:"20",children:Object(C.jsx)("use",{xlinkHref:"#add"})}),Object(C.jsx)("span",{children:v?"Remove from my List":"Add to my list"})]}):"",Object(C.jsx)(M.a,{to:"/movies/".concat(null===i||void 0===i?void 0:i.id,"/new-review"),className:"btn film-card__button",children:"Add review"})]})]})})]}),Object(C.jsx)("div",{className:"film-card__wrap film-card__translate-top",children:Object(C.jsxs)("div",{className:"film-card__info",children:[Object(C.jsx)("div",{className:"film-card__poster film-card__poster--big",children:Object(C.jsx)("img",{src:null===i||void 0===i?void 0:i.posterImage,alt:null===i||void 0===i?void 0:i.name,width:"218",height:"327"})}),Object(C.jsx)("div",{className:"film-card__desc",children:Object(C.jsx)(Q,{film:i})})]})})]}),Object(C.jsxs)("div",{className:"page-content",children:[Object(C.jsxs)("section",{className:"catalog catalog--like-this",children:[Object(C.jsx)("h2",{className:"catalog__title",children:"More like this"}),Object(C.jsx)("div",{className:"catalog__films-list",children:m.map((function(e){return Object(C.jsx)(W,{film:e},e.id)}))})]}),Object(C.jsxs)("footer",{className:"page-footer",children:[Object(C.jsx)(T,{}),Object(C.jsx)("div",{className:"copyright",children:Object(C.jsx)("p",{children:"\xa9 2019 What to watch Ltd."})})]})]})]}):Object(C.jsx)(A,{})};var Z=function(){return Object(C.jsxs)("div",{children:[Object(C.jsxs)("h1",{children:["404.",Object(C.jsx)("br",{}),Object(C.jsx)("small",{children:"Page not found"})]}),Object(C.jsx)(M.a,{to:c.Main,children:"Go to main page"})]})};var $=function(){Object(n.useEffect)((function(){ve.dispatch(function(){var e=Object(h.a)(b.a.mark((function e(t,a,c){var r,n,s;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.get(j.Favorite);case 2:r=e.sent,n=r.data,s=n.map((function(e){return g(e)})),t((a=s,{type:d.LoadfilmsFavorite,payload:{filmsFavorite:a}}));case 6:case"end":return e.stop()}var a}),e)})));return function(t,a,c){return e.apply(this,arguments)}}())}),[]);var e=Object(u.c)((function(e){return e.filmsFavorite}));return Object(u.c)((function(e){return e.isFilmsFavoriteLoaded}))?Object(C.jsxs)("div",{className:"user-page",children:[Object(C.jsxs)("header",{className:"page-header user-page__head",children:[Object(C.jsx)("div",{className:"logo",children:Object(C.jsx)(P,{})}),Object(C.jsx)("h1",{className:"page-title user-page__title",children:"My list"}),Object(C.jsx)(q,{})]}),Object(C.jsxs)("section",{className:"catalog",children:[Object(C.jsx)("h2",{className:"catalog__title visually-hidden",children:"Catalog"}),0===e.length?Object(C.jsx)("p",{children:"There are no favorite movies now"}):Object(C.jsx)("div",{className:"catalog__films-list",children:e.map((function(e){return Object(C.jsx)(W,{film:e},e.id)}))})]}),Object(C.jsxs)("footer",{className:"page-footer",children:[Object(C.jsx)(T,{}),Object(C.jsx)("div",{className:"copyright",children:Object(C.jsx)("p",{children:"\xa9 2019 What to watch Ltd."})})]})]}):Object(C.jsx)(A,{})};var ee=function(e){var t=e.films,a=Object(o.h)().id,c=t.findIndex((function(e){return e.id.toString()===a})),r=t[c],s=Object(o.g)(),i=Object(n.useState)(!0),l=Object(R.a)(i,2),d=l[0],j=l[1],u=Object(n.useState)(!0),m=Object(R.a)(u,2),b=(m[0],m[1]),h=Object(n.useState)(0),f=Object(R.a)(h,2),O=f[0],v=f[1],_=Object(n.useState)("00:00"),p=Object(R.a)(_,2),g=p[0],N=p[1],w=Object(n.useRef)(null);return Object(C.jsxs)("div",{className:"player",children:[Object(C.jsx)("video",{src:r.videoLink,ref:w,className:"player__video",poster:r.backgroundImage,autoPlay:!0,onPlay:function(){j(!0)},onPause:function(){j(!1)},onTimeUpdate:function(e){var t,a=e.currentTarget,c=100*a.currentTime/a.duration,r=(t=a.duration-a.currentTime,x.a.duration(t,"seconds").format("-HH:mm:ss").replace("00:",""));N(r),v(c)},onWaiting:function(){b(!0)},onPlaying:function(){b(!1)},onLoadedData:function(){b(!1)}}),Object(C.jsx)("button",{type:"button",className:"player__exit",onClick:function(){s.push("/movies/".concat(r.id))},children:"Exit"}),Object(C.jsxs)("div",{className:"player__controls",children:[Object(C.jsxs)("div",{className:"player__controls-row",children:[Object(C.jsxs)("div",{className:"player__time",children:[Object(C.jsx)("progress",{className:"player__progress",value:O,max:"100"}),Object(C.jsx)("div",{className:"player__toggler",style:{left:"".concat(O,"%")},children:"Toggler"})]}),Object(C.jsx)("div",{className:"player__time-value",children:g})]}),Object(C.jsxs)("div",{className:"player__controls-row",children:[Object(C.jsxs)("button",{type:"button",className:"player__play",onClick:function(){null!==w.current&&(d?(w.current.pause(),j(!1)):(w.current.play(),j(!0)))},children:[Object(C.jsx)("svg",{viewBox:"0 0 19 19",width:"19",height:"19",children:d?Object(C.jsx)("use",{xlinkHref:"#pause"}):Object(C.jsx)("use",{xlinkHref:"#play-s"})}),Object(C.jsx)("span",{children:"Play"})]}),Object(C.jsx)("div",{className:"player__name",children:"Transpotting"}),Object(C.jsxs)("button",{type:"button",className:"player__full-screen",onClick:function(){null!==w.current&&w.current.requestFullscreen()},children:[Object(C.jsx)("svg",{viewBox:"0 0 27 27",width:"27",height:"27",children:Object(C.jsx)("use",{xlinkHref:"#full-screen"})}),Object(C.jsx)("span",{children:"Full screen"})]})]})]})]})};var te=function(e){var t=e.index,a=e.setRating;return Object(C.jsxs)(C.Fragment,{children:[Object(C.jsx)("input",{onChange:a,className:"rating__input",id:"star-".concat(t),type:"radio",name:"rating",value:10-t}),Object(C.jsxs)("label",{className:"rating__label",htmlFor:"star-".concat(t),children:["Rating ",t]})]})};var ae=function(){var e=Object(o.h)().id,t=Object(u.c)((function(e){return e.films})),a=t.findIndex((function(t){return t.id.toString()===e})),c=t[a],r=Object(n.useRef)(null),s=Object(n.useState)(null),i=Object(R.a)(s,2),l=i[0],d=i[1],j=Object(u.b)(),m=Object(n.useCallback)((function(e){if(l){var t=parseInt(l.value,10);null!==r.current&&null!==t&&(j(function(e){var t=e.rating,a=e.comment,c=e.id;return function(){var e=Object(h.a)(b.a.mark((function e(r,n,s){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,s.post("/comments/".concat(c),{rating:t,comment:a});case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),y.b.error("\u041d\u0435 \u0443\u043a\u0430\u0437\u0430\u043d \u0442\u0435\u043a\u0441\u0442 \u043a\u043e\u043c\u043c\u0435\u043d\u0442\u0430\u0440\u0438\u044f");case 8:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(t,a,c){return e.apply(this,arguments)}}()}({rating:t,comment:r.current.value,id:e})),r.current.value="",l.checked=!1,d(null))}else y.b.error("\u041d\u0435 \u0443\u043a\u0430\u0437 \u0440\u0435\u0439\u0442\u0438\u043d\u0433 \u0444\u0438\u043b\u044c\u043c\u0430")}),[l,j]),f=Object(n.useCallback)((function(e){return d(e.target)}),[]);return Object(C.jsxs)("section",{className:"film-card film-card--full",style:{background:c.backgroundColor},children:[Object(C.jsxs)("div",{className:"film-card__header",children:[Object(C.jsx)("div",{className:"film-card__bg",children:Object(C.jsx)("img",{src:c.backgroundImage,alt:c.name})}),Object(C.jsx)("h1",{className:"visually-hidden",children:"WTW"}),Object(C.jsxs)("header",{className:"page-header",children:[Object(C.jsx)("div",{className:"logo",children:Object(C.jsx)(P,{})}),Object(C.jsx)("nav",{className:"breadcrumbs",children:Object(C.jsxs)("ul",{className:"breadcrumbs__list",children:[Object(C.jsx)("li",{className:"breadcrumbs__item",children:Object(C.jsx)(M.a,{to:"/movies/".concat(c.id),className:"breadcrumbs__link",children:c.name})}),Object(C.jsx)("li",{className:"breadcrumbs__item",children:Object(C.jsx)(M.a,{to:"/movies/".concat(c.id,"/new-review"),className:"breadcrumbs__link",children:"Add review"})})]})}),Object(C.jsx)(q,{})]}),Object(C.jsx)("div",{className:"film-card__poster film-card__poster--small",children:Object(C.jsx)("img",{src:c.posterImage,alt:c.name,width:"218",height:"327"})})]}),Object(C.jsx)("div",{className:"add-review",children:Object(C.jsxs)("form",{action:"#",className:"add-review__form",onSubmit:function(e){e.preventDefault(),m(c.id)},children:[Object(C.jsx)("div",{className:"rating",children:Object(C.jsx)("div",{className:"rating__stars",children:new Array(10).fill(null).map((function(e,t){return Object(C.jsx)(te,{index:t,setRating:f},t)}))})}),Object(C.jsxs)("div",{className:"add-review__text",children:[Object(C.jsx)("textarea",{ref:r,className:"add-review__textarea",name:"review-text",id:"review-text",placeholder:"Review text"}),Object(C.jsx)("div",{className:"add-review__submit",children:Object(C.jsx)("button",{className:"add-review__btn",type:"submit",children:"Post"})})]})]})})]})};var ce=function(){var e=Object(n.useRef)(null),t=Object(n.useRef)(null),a=Object(u.b)();return Object(C.jsxs)("div",{className:"user-page",children:[Object(C.jsxs)("header",{className:"page-header user-page__head",children:[Object(C.jsx)("div",{className:"logo",children:Object(C.jsx)(P,{})}),Object(C.jsx)("h1",{className:"page-title user-page__title",children:"Sign in"})]}),Object(C.jsx)("div",{className:"sign-in user-page__content",children:Object(C.jsxs)("form",{action:"",className:"sign-in__form",onSubmit:function(r){r.preventDefault(),null!==e.current&&null!==t.current&&a(function(e){var t=e.email,a=e.password;return function(){var e=Object(h.a)(b.a.mark((function e(r,n,s){var i,l;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.post(j.Login,{email:t,password:a});case 2:i=e.sent,l=i.data.token,O(l),r(F()),r((n=c.Main,{type:d.RedirectToRoute,payload:n}));case 7:case"end":return e.stop()}var n}),e)})));return function(t,a,c){return e.apply(this,arguments)}}()}({email:e.current.value,password:t.current.value}))},children:[Object(C.jsxs)("div",{className:"sign-in__fields",children:[Object(C.jsxs)("div",{className:"sign-in__field",children:[Object(C.jsx)("input",{ref:e,className:"sign-in__input",type:"email",placeholder:"Email address",name:"user-email",id:"user-email"}),Object(C.jsx)("label",{className:"sign-in__label visually-hidden",htmlFor:"user-email",children:"Email address"})]}),Object(C.jsxs)("div",{className:"sign-in__field",children:[Object(C.jsx)("input",{ref:t,className:"sign-in__input",type:"password",placeholder:"Password",name:"user-password",id:"user-password"}),Object(C.jsx)("label",{className:"sign-in__label visually-hidden",htmlFor:"user-password",children:"Password"})]})]}),Object(C.jsx)("div",{className:"sign-in__submit",children:Object(C.jsx)("button",{className:"sign-in__btn",type:"submit",children:"Sign in"})})]})}),Object(C.jsxs)("footer",{className:"page-footer",children:[Object(C.jsx)(T,{}),Object(C.jsx)("div",{className:"copyright",children:Object(C.jsx)("p",{children:"\xa9 2019 What to watch Ltd."})})]})]})};var re=function(e){var t=e.exact,a=e.path,n=e.render,s=Object(u.c)((function(e){return e.authorizationStatus}));return Object(C.jsx)(o.b,{exact:t,path:a,render:function(){return s===r.Auth?n():Object(C.jsx)(o.a,{to:c.SingIn})}})},ne=a(10),se=Object(ne.a)();var ie=function(){var e=Object(u.c)((function(e){return e.isDataLoaded})),t=Object(u.c)((function(e){return e.films}));return function(e){return e===r.Unknown}(Object(u.c)((function(e){return e.authorizationStatus})))||!e?Object(C.jsx)(A,{}):Object(C.jsx)(o.c,{history:se,children:Object(C.jsxs)(o.d,{children:[Object(C.jsx)(o.b,{exact:!0,path:c.Main,children:Object(C.jsx)(E,{})}),Object(C.jsx)(o.b,{exact:!0,path:c.Movie,children:Object(C.jsx)(X,{})}),Object(C.jsx)(o.b,{exact:!0,path:c.Error,children:Object(C.jsx)(Z,{})}),Object(C.jsx)(re,{exact:!0,path:c.MyList,render:function(){return Object(C.jsx)($,{})}}),Object(C.jsx)(o.b,{exact:!0,path:c.Player,children:Object(C.jsx)(ee,{films:t})}),Object(C.jsx)(re,{exact:!0,path:c.Review,render:function(){return Object(C.jsx)(ae,{})}}),Object(C.jsx)(o.b,{exact:!0,path:c.SingIn,children:Object(C.jsx)(ce,{})})]})})},le=a(15),oe=a(3),de={genre:"All genres",films:[],filmsFavorite:[],filmsSimilar:[],filmPromo:null,count:8,reviews:[],authorizationStatus:r.Unknown,isDataLoaded:!1,isFilmsSimilarLoaded:!1,isFilmsFavoriteLoaded:!1,isFilmLoaded:!1,user:{id:0,email:"",name:"",avatarUrl:"",token:""},film:{id:0,name:"",posterImage:"",previewImage:"",backgroundImage:"",backgroundColor:"",videoLink:"",previewVideoLink:"",description:"",rating:0,scoresCount:0,director:"",starring:[],runTime:0,genre:"",released:0,isFavorite:!1}};var je,ue=a(37),me=a(38),be=a.n(me);!function(e){e[e.Unauthorized=401]="Unauthorized"}(je||(je={}));var he=function(e){var t=be.a.create({baseURL:"https://8.react.pages.academy/wtw",timeout:5e3});return t.interceptors.response.use((function(e){return e}),(function(t){var a=t.response;return(null===a||void 0===a?void 0:a.status)===je.Unauthorized&&e(),Promise.reject(t)})),t.interceptors.request.use((function(e){var t=function(){var e=localStorage.getItem(f);return null!==e&&void 0!==e?e:""}();return t&&(e.headers["x-token"]=t),e})),t},fe=a(39),Oe=(a(70),he((function(){return ve.dispatch((e=r.NoAuth,{type:d.RequireAuthorization,payload:e}));var e}))),ve=Object(le.createStore)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:de,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case d.ChangeActiveGenre:return Object(oe.a)(Object(oe.a)({},e),{},{genre:t.payload});case d.GetFilms:return Object(oe.a)(Object(oe.a)({},e),{},{films:t.payload});case d.IncreaseCountFilms:return Object(oe.a)(Object(oe.a)({},e),{},{count:e.count+t.payload});case d.ResetCount:return Object(oe.a)(Object(oe.a)({},e),{},{count:de.count});case d.ResetFilm:return Object(oe.a)(Object(oe.a)({},e),{},{film:de.film});case d.LoadFilms:var a=t.payload.films;return Object(oe.a)(Object(oe.a)({},e),{},{films:a,isDataLoaded:!0});case d.LoadFilmsSimilar:var c=t.payload.filmsSimilar;return Object(oe.a)(Object(oe.a)({},e),{},{filmsSimilar:c,isFilmsSimilarLoaded:!0});case d.LoadFilm:var n=t.payload.film;return Object(oe.a)(Object(oe.a)({},e),{},{film:n,isFilmLoaded:!0});case d.LoadFilmPromo:var s=t.payload.filmPromo;return Object(oe.a)(Object(oe.a)({},e),{},{filmPromo:s});case d.LoadfilmsFavorite:var i=t.payload.filmsFavorite;return Object(oe.a)(Object(oe.a)({},e),{},{filmsFavorite:i,isFilmsFavoriteLoaded:!0});case d.LoadReviews:var l=t.payload.reviews;return Object(oe.a)(Object(oe.a)({},e),{},{reviews:l});case d.RequireAuthorization:return Object(oe.a)(Object(oe.a)({},e),{},{authorizationStatus:t.payload});case d.RequireLogout:return Object(oe.a)(Object(oe.a)({},e),{},{authorizationStatus:r.NoAuth});case d.LoadUser:var o=t.payload.user;return Object(oe.a)(Object(oe.a)({},e),{},{user:o,authorizationStatus:r.Auth});default:return e}}),Object(ue.composeWithDevTools)(Object(le.applyMiddleware)(fe.a.withExtraArgument(Oe)),Object(le.applyMiddleware)((function(e){return function(e){return function(t){return t.type===d.RedirectToRoute&&se.push(t.payload),e(t)}}}))));ve.dispatch(F()),ve.dispatch(L()),ve.dispatch(function(){var e=Object(h.a)(b.a.mark((function e(t,a,c){var r,n,s;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.get(j.Films);case 2:r=e.sent,n=r.data,s=n.map((function(e){return g(e)})),t((a=s,{type:d.LoadFilms,payload:{films:a}}));case 6:case"end":return e.stop()}var a}),e)})));return function(t,a,c){return e.apply(this,arguments)}}()),l.a.render(Object(C.jsx)(u.a,{store:ve,children:Object(C.jsxs)(s.a.StrictMode,{children:[Object(C.jsx)(y.a,{}),Object(C.jsx)(ie,{})]})}),document.getElementById("root"))}},[[71,1,2]]]);
//# sourceMappingURL=main.0075b301.chunk.js.map